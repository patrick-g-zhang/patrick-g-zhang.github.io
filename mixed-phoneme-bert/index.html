<!DOCTYPE html>
<html lang="en">
<head>
  <title>MIXED-PHONEME BERT: IMPROVING BERT WITH MIXED PHONEME ANDSUP-PHONEME REPRESENTATIONS FOR TEXT TO SPEECH</title>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.4.1/css/bootstrap.min.css">
  <link rel=¨stylesheet¨ type="text/css" href="pib.css">
  <script src="pib.js"></script>
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
  <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.4.1/js/bootstrap.min.js"></script>

</head>
<body>
<h1 align="center">
Mixed-Phoneme BERT: Improving BERT with Mixed Phoneme and Sup-Phoneme Representations for Text to Speech
</h1>



<div class="container">
<h2>Abstract</h2>
Recently, leveraging BERT pre-training to improve the phoneme encoder in text to speech (TTS) has drawn increasing attention.  However, current works remain several flaws: 1) some works directly apply pre-training with character-based units to enhance phoneme encoder, which causes the inconsistency between pre-training and fine-tuning since TTS encoder takes phoneme as input instead of character-based units; 2) some of them focus on phoneme-level pre-training, which can alleviate the input mismatch but lack the ability to modelling rich representations and sematic information due to limited phoneme vocabulary. In this paper, we propose Mixed-Phoneme BERT, a novel variant of  BERT model that uses mixed phoneme and sup-phoneme representations to enhance the learning capability. Specifically, we merge the adjacent phonemes into sup-phonemes (which have a much larger vocabulary size than that of phonemes), and combine the phoneme sequence and the merged sup-phoneme sequence together as the model input, which can enhance the model capacity to learn rich contextual representations due to increased vocabulary size. Experiment results demonstrate that our proposed Mixed-Phoneme BERT significantly improves the TTS performance with 0.296 CMOS gain compared with the FastSpeech 2 baseline and 0.111 CMOS gain compared with the Phoneme BERT with only phoneme-level pre-training. 
</div>

<div class="container">
    <h2>Part 1. Audio Samples</h2>
    <i>
    These examples are randomly sampled from the MOS and CMOS evaluation set for <b> Table 1 </b> in the paper.
    </i>

  <h3> Audio Samples </h3>
  <span>
        1. The due relation of letter to pictures and other ornament was thoroughly understood by the old printers.
  </span>
  <table class="table table-hover">
    <thead>
      <tr>
        <th>Recording</th>
        <th>PWG copy synthesis</th>
        <th>Fastspeech 2</th>
      </tr>
    </thead>
    <tbody>

      <tr>
        <td>
                <audio src="table1/gt/LJ001-0178.wav" controls=""></audio>
        </td>

        <td>
                <audio src="table1/pwg/LJ001-0178.wav" controls=""></audio>
        </td>    
        <td>
                <audio src="table1/fs2/T000020.wav" controls=""></audio>
        </td>    
      </tr>

    </tbody>
  </table>

   <table class="table table-hover">
    <thead>
      <tr>
        <th>Fastspeech 2 with unpre-trained Mixed-Phoneme BERT</th>
        <th>Fastspeech 2 with pre-trained Mixed-Phoneme BERT</th>
      </tr>
    </thead>
    <tbody>

      <tr>
        <td>
                <audio src="table1/unpre-mp/T000020.wav" controls=""></audio>
        </td>

        <td>
                <audio src="table1/pre-mp/T000020.wav" controls=""></audio>
        </td>       
      </tr>

    </tbody>
  </table>

  <!-- second sentence -->

  <span>
                2. Printing, then, for our purpose, may be considered as the art of making books by means of movable types.
  </span>
  <table class="table table-hover">
    <thead>
      <tr>
        <th>Recording</th>
        <th>PWG copy synthesis</th>
        <th>Fastspeech 2</th>
      </tr>
    </thead>
    <tbody>

      <tr>
        <td>
                <audio src="table1/gt/LJ001-0009.wav" controls=""></audio>
        </td>

        <td>
                <audio src="table1/pwg/LJ001-0009.wav" controls=""></audio>
        </td>    
        <td>
                <audio src="table1/fs2/T000023.wav" controls=""></audio>
        </td>    
      </tr>

    </tbody>
  </table>

   <table class="table table-hover">
    <thead>
      <tr>
        <th>Fastspeech 2 with unpre-trained Mixed-Phoneme BERT</th>
        <th>Fastspeech 2 with pre-trained Mixed-Phoneme BERT</th>
      </tr>
    </thead>
    <tbody>

      <tr>
        <td>
                <audio src="table1/unpre-mp/T000023.wav" controls=""></audio>
        </td>

        <td>
                <audio src="table1/pre-mp/T000023.wav" controls=""></audio>
        </td>       
      </tr>

    </tbody>
  </table>

<!-- Third sentences -->

 <span>
                3. Scientific studies have evaluated surgical masks, but relatively few have looked at whether cloth masks can stop virus transmission.
  </span>
   <table class="table table-hover">
    <thead>
      <tr>
        <th>Fastspeech 2 </th>
        <th>Fastspeech 2 with unpre-trained Mixed-Phoneme BERT</th>
        <th>Fastspeech 2 with pre-trained Mixed-Phoneme BERT</th>
      </tr>
    </thead>
    <tbody>

      <tr>
        <td>
                <audio src="table1/fs2/T000001.wav" controls=""></audio>
        </td>

        <td>
                <audio src="table1/unpre-mp/T000001.wav" controls=""></audio>
        </td>

        <td>
                <audio src="table1/pre-mp/T000001.wav" controls=""></audio>
        </td>       
      </tr>

    </tbody>
  </table>



<!-- Third sentences -->

 <span>
                4. It has carried out three orbital corrections as well as equipment tests and remains in good condition.
  </span>
   <table class="table table-hover">
    <thead>
      <tr>
        <th>Fastspeech 2 </th>
        <th>Fastspeech 2 with unpre-trained Mixed-Phoneme BERT</th>
        <th>Fastspeech 2 with pre-trained Mixed-Phoneme BERT</th>
      </tr>
    </thead>
    <tbody>

      <tr>
        <td>
                <audio src="table1/fs2/T000036.wav" controls=""></audio>
        </td>

        <td>
                <audio src="table1/unpre-mp/T000036.wav" controls=""></audio>
        </td>

        <td>
                <audio src="table1/pre-mp/T000036.wav" controls=""></audio>
        </td>       
      </tr>

    </tbody>
  </table>


  <!-- Third sentences -->

 <span>
                5. The dialogue between Europe and China has strengthened and become more balanced these past few years.
  </span>
   <table class="table table-hover">
    <thead>
      <tr>
        <th>Fastspeech 2 </th>
        <th>Fastspeech 2 with unpre-trained Mixed-Phoneme BERT</th>
        <th>Fastspeech 2 with pre-trained Mixed-Phoneme BERT</th>
      </tr>
    </thead>
    <tbody>

      <tr>
        <td>
                <audio src="table1/fs2/T000040.wav" controls=""></audio>
        </td>

        <td>
                <audio src="table1/unpre-mp/T000040.wav" controls=""></audio>
        </td>

        <td>
                <audio src="table1/pre-mp/T000040.wav" controls=""></audio>
        </td>       
      </tr>

    </tbody>
  </table>

<h3> Compared with the PnG BERT </h3>
 	<i>
    	These examples are sampled from the CMOS evaluation set for <b> Table 2 </b> in the paper.
 	</i>

 	  <!-- First sentences -->
</br>
 <span>
                1. Sometimes the notion of going out to a movie theater seems like a dream from previous life.
  </span>
   <table class="table table-hover">
    <thead>
      <tr>
        <th>Fastspeech 2 with pre-trained Png BERT</th>
        <th>Fastspeech 2 with pre-trained Mixed-Phoneme BERT</th>
      </tr>
    </thead>
    <tbody>

      <tr>
        <td>
                <audio src="table2_new/png/T000008.wav" controls=""></audio>
        </td>

        <td>
                <audio src="table2_new/mp/T000008.wav" controls=""></audio>
        </td>       
      </tr>

    </tbody>
  </table>



    <!-- Second sentences -->

 <span>
                2. The fire or light, when kept in by the eyelids, equalizes the inward motions, and there is rest accompanied by few dreams.
  </span>
   <table class="table table-hover">
    <thead>
      <tr>
        <th>Fastspeech 2 with pre-trained PnG BERT</th>
        <th>Fastspeech 2 with pre-trained Mixed-Phoneme BERT</th>
      </tr>
    </thead>
    <tbody>

      <tr>
        <td>
                <audio src="table2_new/png/T000016.wav" controls=""></audio>
        </td>

        <td>
                <audio src="table2_new/mp/T000016.wav" controls=""></audio>
        </td>       
      </tr>

    </tbody>
  </table>

    <!-- Third sentences -->

 <span>
                3. For although the Chinese took impressions from wood blocks engraved in relief for centuries before the wood-cutters of the Netherlands.
  </span>
   <table class="table table-hover">
    <thead>
      <tr>
        <th>Fastspeech 2 with pre-trained PnG BERT</th>
        <th>Fastspeech 2 with pre-trained Mixed-Phoneme BERT</th>
      </tr>
    </thead>
    <tbody>

      <tr>
        <td>
                <audio src="table2_new/png/T000021.wav" controls=""></audio>
        </td>

        <td>
                <audio src="table2_new/mp/T000021.wav" controls=""></audio>
        </td>       
      </tr>

    </tbody>
  </table>

    <!-- Forth sentences -->

 <span>
                4. Very much of squalor and discomfort will be endured before the last trinket or the last pretense of pecuniary decency is put away.
  </span>
   <table class="table table-hover">
    <thead>
      <tr>
        <th>Fastspeech 2 with pre-trained PnG BERT</th>
        <th>Fastspeech 2 with pre-trained Mixed-Phoneme BERT</th>
      </tr>
    </thead>
    <tbody>

      <tr>
        <td>
                <audio src="table2_new/png/T000022.wav" controls=""></audio>
        </td>

        <td>
                <audio src="table2_new/mp/T000022.wav" controls=""></audio>
        </td>       
      </tr>

    </tbody>
  </table>


    <!-- Fifth sentences -->

 <span>
                5. Printing, then, for our purpose, may be considered as the art of making books by means of movable types.
  </span>
   <table class="table table-hover">
    <thead>
      <tr>
        <th>Fastspeech 2 with pre-trained PnG BERT</th>
        <th>Fastspeech 2 with pre-trained Mixed-Phoneme BERT</th>
      </tr>
    </thead>
    <tbody>

      <tr>
        <td>
                <audio src="table2_new/png/T000023.wav" controls=""></audio>
        </td>

        <td>
                <audio src="table2_new/mp/T000023.wav" controls=""></audio>
        </td>       
      </tr>

    </tbody>
  </table>



<h2>Part 2. Ablation Studies </h2>

<h3>The Effectiveness of Mixed Phoneme and Sup-Phoneme Representations </h3>
    <i>
    These examples are sampled from the CMOS evaluation set for <b> Table 3 </b> in the paper.
    </i>

  <!-- First sentences -->
</br>
 <span>
                1. In the meantime, renters who have lost their jobs or are sick because of the virus should contact their landlords.
  </span>
   <table class="table table-hover">
    <thead>
      <tr>
        <th>Fastspeech 2 with pre-trained Phoneme BERT</th>
        <th>Fastspeech 2 with pre-trained Mixed-Phoneme BERT</th>
      </tr>
    </thead>
    <tbody>

      <tr>
        <td>
                <audio src="table2/pre-p/T000007.wav" controls=""></audio>
        </td>

        <td>
                <audio src="table2/pre-mp/T000007.wav" controls=""></audio>
        </td>       
      </tr>

    </tbody>
  </table>



    <!-- Second sentences -->

 <span>
                2. Sometimes the notion of going out to a movie theater seems like a dream from previous life.
  </span>
   <table class="table table-hover">
    <thead>
      <tr>
        <th>Fastspeech 2 with pre-trained Phoneme BERT</th>
        <th>Fastspeech 2 with pre-trained Mixed-Phoneme BERT</th>
      </tr>
    </thead>
    <tbody>

      <tr>
        <td>
                <audio src="table2/pre-p/T000008.wav" controls=""></audio>
        </td>

        <td>
                <audio src="table2/pre-mp/T000008.wav" controls=""></audio>
        </td>       
      </tr>

    </tbody>
  </table>

    <!-- Third sentences -->

 <span>
                3. All this comes at a moment when MLB faces a labor crisis that threatens the future of the entire industry.
  </span>
   <table class="table table-hover">
    <thead>
      <tr>
        <th>Fastspeech 2 with pre-trained Phoneme BERT</th>
        <th>Fastspeech 2 with pre-trained Mixed-Phoneme BERT</th>
      </tr>
    </thead>
    <tbody>

      <tr>
        <td>
                <audio src="table2/pre-p/T000012.wav" controls=""></audio>
        </td>

        <td>
                <audio src="table2/pre-mp/T000012.wav" controls=""></audio>
        </td>       
      </tr>

    </tbody>
  </table>

    <!-- Forth sentences -->

 <span>
                4. The fire or light, when kept in by the eyelids, equalizes the inward motions, and there is rest accompanied by few dreams.
  </span>
   <table class="table table-hover">
    <thead>
      <tr>
        <th>Fastspeech 2 with pre-trained Phoneme BERT</th>
        <th>Fastspeech 2 with pre-trained Mixed-Phoneme BERT</th>
      </tr>
    </thead>
    <tbody>

      <tr>
        <td>
                <audio src="table2/pre-p/T000016.wav" controls=""></audio>
        </td>

        <td>
                <audio src="table2/pre-mp/T000016.wav" controls=""></audio>
        </td>       
      </tr>

    </tbody>
  </table>


    <!-- Fifth sentences -->

 <span>
                5. I told them I knew no remedy but leaving me behind next time, and could have told them that my looks were suitable to my fortune, though not to a feast.
  </span>
   <table class="table table-hover">
    <thead>
      <tr>
        <th>Fastspeech 2 with pre-trained Phoneme BERT</th>
        <th>Fastspeech 2 with pre-trained Mixed-Phoneme BERT</th>
      </tr>
    </thead>
    <tbody>

      <tr>
        <td>
                <audio src="table2/pre-p/T000017.wav" controls=""></audio>
        </td>

        <td>
                <audio src="table2/pre-mp/T000017.wav" controls=""></audio>
        </td>       
      </tr>

    </tbody>
  </table>





<h3>The Effectiveness of Fine-Tuning Strategy </h3>
    <i>
    These examples are sampled from the CMOS evaluation set for <b> Table 4 </b> in the paper.
    </i>

  <!-- First sentences -->
</br>
 <span>
                1. As demand is expected to be huge, an expert panel will help screen the proposals for the most promising candidates. 
  </span>
   <table class="table table-hover">
    <thead>
      <tr>
        <th>only phoneme</th>
        <th>only sub-phoneme</th>
        <th>Fastspeech 2 with pre-trained Mixed-Phoneme BERT</th>
      </tr>
    </thead>
    <tbody>

      <tr>
        <td>
                <audio src="table3/only-ph/T000035.wav" controls=""></audio>
        </td>


        <td>
                <audio src="table3/only-sup/T000035.wav" controls=""></audio>
        </td>

        <td>
                <audio src="table2/pre-mp/T000035.wav" controls=""></audio>
        </td>       
      </tr>

    </tbody>
  </table>



    <!-- Second sentences -->

 <span>
                2. His hosts, on the other hand, wore an uneasy manner that might have been the hallmark of conscious depravity.
  </span>
   <table class="table table-hover">
    <thead>
        <tr>
        <th>only phoneme</th>
        <th>only sub-phoneme</th>
        <th>Fastspeech 2 with pre-trained Mixed-Phoneme BERT</th>
      </tr>
    </thead>
    <tbody>

      <tr>
       <td>
                <audio src="table3/only-ph/T000034.wav" controls=""></audio>
        </td>


        <td>
                <audio src="table3/only-sup/T000034.wav" controls=""></audio>
        </td>

        <td>
                <audio src="table2/pre-mp/T000034.wav" controls=""></audio>
        </td>       
      </tr>

    </tbody>
  </table>

    <!-- Third sentences -->

 <span>
                3. Whether much or little consideration had been directed to the result, Miss Chancellor certainly would not have incurred this reproach.
  </span>
   <table class="table table-hover">
    <thead>
      <tr>
        <th>only phoneme</th>
        <th>only sub-phoneme</th>
        <th>Fastspeech 2 with pre-trained Mixed-Phoneme BERT</th>
      </tr>
    </thead>
    <tbody>

      <tr>
       <td>
                <audio src="table3/only-ph/T000033.wav" controls=""></audio>
        </td>


        <td>
                <audio src="table3/only-sup/T000033.wav" controls=""></audio>
        </td>

        <td>
                <audio src="table2/pre-mp/T000033.wav" controls=""></audio>
        </td>       
      </tr>

    </tbody>
  </table>

    <!-- Forth sentences -->

 <span>
                4. Most of Caxton's own types are of an earlier character, though they also much resemble Flemish or Cologne letter.
  </span>
   <table class="table table-hover">
    <thead>
      <tr>
        <th>only phoneme</th>
        <th>only sub-phoneme</th>
        <th>Fastspeech 2 with pre-trained Mixed-Phoneme BERT</th>
      </tr>
    </thead>
    <tbody>

      <tr>
         <td>
                <audio src="table3/only-ph/T000032.wav" controls=""></audio>
        </td>


        <td>
                <audio src="table3/only-sup/T000032.wav" controls=""></audio>
        </td>

        <td>
                <audio src="table2/pre-mp/T000032.wav" controls=""></audio>
        </td>       
      </tr>

    </tbody>
  </table>


    <!-- Fifth sentences -->

 <span>
                5. I have a remedy against thirst, quite contrary to that which is good against the biting of a mad dog.
  </span>
   <table class="table table-hover">
    <thead>
       <tr>
        <th>only phoneme</th>
        <th>only sub-phoneme</th>
        <th>Fastspeech 2 with pre-trained Mixed-Phoneme BERT</th>
      </tr>
    </thead>
    <tbody>

      <tr>
       <td>
                <audio src="table3/only-ph/T000025.wav" controls=""></audio>
        </td>


        <td>
                <audio src="table3/only-sup/T000025.wav" controls=""></audio>
        </td>

        <td>
                <audio src="table2/pre-mp/T000025.wav" controls=""></audio>
        </td>       
      </tr>

    </tbody>
  </table>







</div>


</body>
</html>

